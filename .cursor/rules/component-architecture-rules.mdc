---
alwaysApply: true
---

# 组件拆分与职责边界规则（React / Next.js）

> 目标：
> 强制组件遵循「UI 纯展示 + Hook 逻辑 + 外层组合」三层结构，
> 避免上帝组件，提升可维护性与可复用性。

---

## 一、核心原则（强制）

对于任何中等及以上复杂度的组件：

**必须拆分为三层：**

1. 纯 UI 展示组件：`XxxUI`
2. 副作用与逻辑封装：`useXxx`
3. 外层组合组件：`Xxx`

心智模型：

```
Xxx
   ↓ 调用
useXxx
   ↓ 返回数据 + 回调
XxxUI
```

---

## 二、纯 UI 组件规则（XxxUI）

### 1. 命名规则（强制）

* 所有纯 UI 组件 **必须命名为**：

```
XxxUI
```

例如：

* `LoginFormUI`
* `UserListUI`
* `ModalUI`

---

### 2. 职责边界（强制）

`XxxUI` 组件必须：

* 只负责：

  * JSX 结构
  * 样式
  * 展示逻辑

* 只能通过 props 接收数据与回调

---

### 3. 允许做的事情

* 渲染 props 传入的数据
* 绑定事件回调（`onClick` / `onChange` 等）
* 简单展示级条件渲染

---

### 4. 禁止做的事情（强制）

`XxxUI` 中 **严禁**：

* 使用：

  * `useState`
  * `useEffect`
  * `useContext`

* 直接请求接口

* 操作 `localStorage` / `sessionStorage`

* 使用定时器

* 读写路由

* 调用业务服务

* 复杂业务判断

---

## 三、逻辑 Hook 规则（useXxx）

### 1. 命名规则（强制）

* 所有逻辑 Hook **必须命名为**：

```
useXxx
```

例如：

* `useLoginForm`
* `useUserList`
* `useModal`

---

### 2. 职责边界（强制）

`useXxx` Hook 负责：

* 管理 state（`useState`）
* 处理副作用（`useEffect`）
* 请求接口
* 业务逻辑判断
* 封装事件处理函数

---

### 3. 返回值规范（强制）

`useXxx` **必须返回一个对象**，例如：

```
{
  state: { ... },
  actions: { ... },
  handlers: { ... }
}
```

目的：

* 明确区分：

  * 数据（state）
  * 行为（actions）
  * 事件（handlers）

---

## 四、外层组合组件规则（Xxx）

### 1. 命名规则（强制）

* 外层组合组件 **必须命名为**：

```
Xxx
```

例如：

* `LoginFormComponent`
* `UserListComponent`
* `ModalComponent`

---

### 2. 职责边界（强制）

`Xxx` 负责：

* 调用 `useXxx`
* 把数据与回调传给 `XxxUI`
* 作为“胶水层”进行组合

---

### 3. 禁止做的事情（强制）

`Xxx` 中 **不应该**：

* 包含复杂业务逻辑
* 直接写 JSX 结构（应交给 UI 层）
* 再写一套 state / effect

---

## 五、什么时候可以不拆？

只有在以下情况，才允许不拆三层结构：

* 组件非常简单（例如：只渲染一个按钮）
* 没有任何副作用
* 没有任何业务逻辑
* 没有状态管理

即：

> 一眼能看完、没逻辑、没副作用的小组件

---

## 六、强制执行原则

在生成组件代码时：

* 必须遵守：

  * UI / Hook / Component 三层拆分
* 必须说明：

  * 哪一层负责什么
  * 为什么要这样拆

禁止：

* 把副作用写进 UI 层
* 把 JSX 写进 Hook 里
* 把所有逻辑塞进一个组件

---

## 七、最终目标

这套规则的目的：

* 强制职责分离
* 降低组件复杂度
* 提高可维护性
* 提高逻辑复用率
* 帮助建立正确的组件架构思维

---

## 八、可选增强规则（推荐）

> 下面规则不是强制，但强烈推荐在项目中采用。

* `XxxUI` 应尽量使用 `React.memo`
* `useXxx` 不应直接操作 DOM
* props 类型应单独放在 `types.ts`
* 业务服务应从 Hook 中调用，而不是 UI 层

---

## 九、标准目录结构示例

```
components/
  login-form/
    LoginFormUI.tsx
    LoginFormComponent.tsx
    useLoginForm.ts
    types.ts
```

---

## 十、一句话总结

> UI 只负责展示，Hook 只负责逻辑，Component 只负责拼装。
